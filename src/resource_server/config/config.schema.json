{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://github.com/ternaustralia/rs-remote-job/config.schema.json",
    "title": "Endpoints",
    "description": "JSON configurations for resource server, defining endpoints supported",
    "type": "object",
    "properties": {
      "parameters": {
        "description": "List of parameters supplied to this resource server",
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string"
            },
            "type": {
              "type": "string",
              "enum": [
                "string",
                "int",
                "bool",
                "float",
                "double"
              ]
            },
            "default": {
                "type": ["string", "number"]
            }
          },
          "required": [
            "name",
            "type",
            "default"
          ]
        },
        "minItems": 0,
        "uniqueItems": true
      },
      "endpoints": {
        "description": "List of endpoints supported",
        "type": "array",
        "items": {
          "type": ["string", "number", "boolean", "object"],
          "properties": {
            "name": {
              "type": "string",
              "description": "name of this endpoint"
            },
            "async": {
              "type": "boolean"
            },
            "httpMethod": {
              "type": "string",
              "enum": [
                "GET",
                "POST",
                "DELETE"
              ]
            },
            "exec": {
              "type": "object",
              "description": "The command to be executed in login host. Command parameters (if any) are replaced with user supplied parameter values, or the corresponding default values",
              "properties": {
                "parameters": {
                  "type": "array",
                  "description": "List of parameters supplied to this command/endpoint",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "type": {
                        "type": "string"
                      },
                      "default": {
                        "type": ["string", "number"]
                      }
                    },
                    "required": [
                      "name",
                      "type"
                    ]
                  },
                  "minItems": 0,
                  "uniqueItems": true
                },
                "command": {
                  "type": "string"
                }
              },
              "required": [
                "parameters",
                "command"
              ]
            },
            "output": {
              "type": ["object", "null"],
              "description": "The output format, if defined in string then ignore the exec part",
              "properties": {
                "type": {
                  "type": "string",
                  "enum": [
                    "regex",
                    "text"
                  ]
                },
                "value": {
                  "type": "string"
                }
              },
              "required": [
                "type",
                "value"
              ]
            },
            "requireMatch": {
              "type": "boolean"
            },
            "failFatal": {
              "type": "boolean"
            },
            "formatFatal": {
              "type": "boolean"
            },
            "host": {
              "type": "string"
            },
            "port": {
              "type": ["string", "integer"]
            }
          },
          "required": [
            "name",
            "async",
            "httpMethod",
            "output",
            "requireMatch",
            "failFatal",
            "formatFatal",
            "host",
            "port"
          ]
        },
        "minItems": 1,
        "uniqueItems": true
      }
    },
    "required": [
      "endpoints"
    ]
}